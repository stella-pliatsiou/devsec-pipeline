#!/bin/sh
echo "[pre-commit] Running local checks..."

if [ -f package.json ]; then
  npm test || { echo "❌ Unit tests failed"; exit 1; }
fi

semgrep --config auto --quiet || { echo "❌ Semgrep issues found"; exit 1; }

docker run --rm -v "$(pwd):/scan" trufflesecurity/trufflehog:latest filesystem --path /scan || true

echo "[pre-commit] ✅ OK"
exit 0
